<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>CTC</title>
    <link rel="icon" type="image/jpg" href="assets/ctcooljc-noBG.png" />

    <link rel="stylesheet" href="styles/general.css" />
    <link rel="stylesheet" href="styles/home/header.css" />
    <link rel="stylesheet" href="styles/home/hero.css" />
    <link rel="stylesheet" href="styles/home/orderOfService.css" />
    <link rel="stylesheet" href="styles/footer.css" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Anton+SC&display=swap"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Alegreya+SC:ital,wght@0,400;0,500;0,700;0,800;0,900;1,400;1,500;1,700;1,800;1,900&display=swap"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Rampart+One&display=swap"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Erica+One&family=Train+One&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- Navbar section -->
    <header class="header-section">
      <nav class="navbar">
        <div class="left-nav">
          <div class="img-area">
            <a href="index.html">
              <img
                class="church-logo"
                src="/assets/ctcooljc-noBG.png"
                alt="church-logo"
              />
            </a>
          </div>
        </div>

        <div class="right-nav">
          <ul>
            <li><a href="about.html">About</a></li>
            <li><a href="mothers.html">Mothers</a></li>
            <li><a href="live.html">Services</a></li>
            <li><a href="events.html">Events</a></li>
            <li><a href="contact.html">Contact</a></li>
            <li><a href="donation.html">Donate</a></li>
          </ul>
        </div>

        <div class="hamburger">
          <button id="bTn">
            <img
              class="hamburger-icon"
              src="/assets/icons/hamburger.png"
              alt="hamburger-icon"
            />
          </button>
        </div>

        <div id="menu" class="menu">
          <button id="closeMenu" class="close-menu">&times;</button>
          <ul>
            <li><a href="about.html">About</a></li>
            <li><a href="mothers.html">Mothers</a></li>
            <li><a href="live.html">Services</a></li>
            <li><a href="events.html">Events</a></li>
            <li><a href="contact.html">Contact</a></li>
            <li><a href="donation.html">Donate</a></li>
          </ul>
        </div>
      </nav>
    </header>
    <script>
      document.getElementById("bTn").addEventListener("click", function () {
        document.getElementById("menu").classList.toggle("active");
      });

      document.addEventListener("click", function (event) {
        const menu = document.getElementById("menu");
        const menuButton = document.getElementById("bTn");

        if (
          !menu.contains(event.target) &&
          !menuButton.contains(event.target)
        ) {
          menu.classList.remove("active");
        }
      });

      document
        .getElementById("closeMenu")
        .addEventListener("click", function () {
          document.getElementById("menu").classList.remove("active");
        });
    </script>

    <!-- Hero section -->
    <section>
      <div class="hero-section">
        <div class="hero-content">
          <div class="video-container">
            <video
              id="heroVideo"
              class="ctc-video"
              autoplay
              muted
              loop
              playsinline
              preload="auto"
              poster="assets/CTChurch_PFP.jpg"
            >
              <!-- Default video -->
              <source
                src="assets/videos/CTC-largeScreens-homeBG.mp4"
                type="video/mp4"
                id="videoSource"
              />
              Your browser does not support the video tag.
            </video>
          </div>

          <div class="church-title">
            <span class="ctc">C</span>ommunity <span class="ctc">T</span>emple
            <span class="ctc">C</span>hurch <span class="ctc">O</span>f
            <span class="ctc">O</span>ur <span class="ctc">L</span>ord
            <span class="ctc">J</span>esus <span class="ctc">C</span>hrist
          </div>

          <div class="next-section">
            <a href="#next">
              <img
                class="down-arrow"
                src="/assets/icons/down-arrow.svg"
                alt="down arrow to move down to next section"
              />
            </a>
          </div>
        </div>
      </div>
    </section>
    <script>
      let currentVideoSource = localStorage.getItem("currentVideoSource") || "";

      function updateVideoSource() {
        const videoElement = document.getElementById("heroVideo");
        const videoSource = document.getElementById("videoSource");
        let newSource;

        // Determine which video to use based on screen width
        if (window.innerWidth <= 480) {
          newSource = "assets/videos/CTC-Mobile-optimized.mp4"; // Mobile video
        } else {
          newSource = "assets/videos/CTC-largeScreens-homeBG.mp4"; // Desktop video
        }

        // Only update if the source is different to avoid unnecessary reloads
        if (currentVideoSource !== newSource) {
          videoSource.src = newSource;
          videoElement.load(); // Load the new video source
          videoElement.play(); // Ensure video plays immediately after load
          currentVideoSource = newSource; // Update the current source to the new one
          localStorage.setItem("currentVideoSource", newSource); // Save the source in localStorage
        }
      }

      // Use IntersectionObserver to only play the video when it's in view
      function handleVisibility() {
        const videoElement = document.getElementById("heroVideo");
        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                if (videoElement.paused) {
                  videoElement.play(); // Play video if in view
                }
              } else {
                videoElement.pause(); // Pause video if out of view
              }
            });
          },
          { threshold: 0.5 }
        ); // Adjust the threshold as needed

        observer.observe(videoElement);
      }

      // Update video source on page load and when the window is resized, but only for major resizes
      window.addEventListener("load", () => {
        updateVideoSource();
        handleVisibility();
      });

      window.addEventListener("resize", () => {
        // Add a debounce to prevent constant firing on minor window adjustments
        clearTimeout(window.resizeTimeout);
        window.resizeTimeout = setTimeout(updateVideoSource, 200); // Adjust delay as necessary
      });
    </script>

    <!-- Order of service section -->
    <section class="order-of-service-section" id="next">
      <div class="order-of-service">
        <p>Order Of Service:</p>
        <ul>
          <li>- Monday night Prayer and Tarry at 7:00 p.m.</li>

          <li>- Wednesday night Prayer/Bible Study at 6:30 p.m. - 8:00 p.m.</li>

          <li>- Sunday School at 10:30 a.m.</li>

          <li>- Sunday Morning Worship at 11:35 a.m.</li>
        </ul>
      </div>
    </section>

    <div class="location">
      <iframe
        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3041.4953260560064!2d-79.89658462464821!3d33.73494797327808!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x88ffbd61027013b7%3A0xf82b3435ec8503a3!2s385%20McClam%20Rd%2C%20Cades%2C%20SC%2029518!5e1!3m2!1sen!2sus!4v1727304482404!5m2!1sen!2sus"
        class="map"
        style="border: 0"
        allowfullscreen=""
        loading="lazy"
        referrerpolicy="no-referrer-when-downgrade"
      ></iframe>
    </div>

    <!--Footer section-->
    <footer>
      <div class="footer-container">
        <div class="footer-content">
          <p>
            C.T.C.O.O.L.J.C
            <span class="footer-year" id="footer-year"></span>
          </p>
          <div class="contact-info">
            <p>
              Secretary Sister Shannon Singletary Contact Information:
              843-372-5839
            </p>
            <p>385 McClam Rd, Cades, SC 29518</p>
          </div>
        </div>
      </div>
    </footer>

    <script src="js/script.js" type="module"></script>
  </body>
</html>
